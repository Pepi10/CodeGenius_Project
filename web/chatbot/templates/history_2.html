    <div class="container" id="container">
        <div class="chat-container" id="chatContainer">
            <div class="chat-area">
                <h2>Chat</h2>
                <div class="chat-content" id="chat-area">
                    <div class="message bot-message">
                        <div class="message-content">{{ chatting_output }}</div>
                    </div>
                </div>
            </div>
            <div class="code-area-container">
                <div class="code-example">
                    <h2>Examples</h2>
                    <pre><code>{{ code }}</code></pre>
                </div>
                <div class="doc-links">
                    <h2>Docs</h2>
                    <a href="{{ doc_url }}" target="_blank">{{ keyword }}</a>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.getElementById('toggleButton').addEventListener('click', function() {
            var historyBar = document.getElementById('historyBar');
            var container = document.getElementById('container');
            var chatContainer = document.getElementById('chatContainer');
            if (historyBar.style.display === 'none') {
                historyBar.style.display = 'block';
                container.style.marginLeft = '250px';
                container.style.width = 'calc(100% - 250px)';
                chatContainer.style.width = '100%';
                chatContainer.style.maxWidth = '1200px';
                this.textContent = '▲';
            } else {
                historyBar.style.display = 'none';
                container.style.marginLeft = '0';
                container.style.width = '100%';
                chatContainer.style.width = '100%';
                chatContainer.style.maxWidth = '2000px';
                this.textContent = '▼';
            }
        });
    </script>
        




    <script>
        function loadChatHistory() {
            fetch("{% url 'history_render' %}")
                .then(response => response.json())
                .then(data => {
                    // 서버에서 받은 렌더링된 HTML을 페이지에 삽입
                    const renderedHtml = data.rendered_html;
                    document.getElementById('chat-history-container').innerHTML = renderedHtml;

                    // historyJson을 HTML로 표시
                    const historyJson = data.history_json;
                    const list_boxs = document.getElementById('list-box');

                    // 각 기록에 대해 반복하며 HTML 요소 생성
                    historyJson.forEach(record => {
                        // 생성 날짜 버튼 생성 및 설정
                        const createdAtButton = document.createElement('button');  // 새로운 button 요소 생성
                        createdAtButton.classList.add('date-button');  // 'date-button' 클래스 추가
                        createdAtButton.textContent = new Date(record.created_at).toISOString().split('T')[0];  // 날짜 형식을 "Y-m-d"로 변환하여 설정

                        // 키워드 버튼 생성 및 설정
                        const keywordButton = document.createElement('button');  // 새로운 button 요소 생성
                        keywordButton.classList.add('keyword-button');  // 'keyword-button' 클래스 추가
                        keywordButton.textContent = record.keyword;  // 버튼 텍스트로 키워드 설정

                        // 생성된 버튼들을 recordElement에 추가
                        recordElement.appendChild(createdAtButton);  // createdAtButton 추가
                        recordElement.appendChild(keywordButton);  // keywordButton 추가

                        // jsonHistoryContainer에 recordElement 추가
                        list_boxs.appendChild(recordElement);
                    });

                })
                .catch(error => console.error('Error:', error));
        }

        // 페이지가 로드될 때 채팅 기록을 로드
        document.addEventListener('DOMContentLoaded', loadChatHistory);
    </script>

   


    <!--Django 서버에 POST 요청을 보내고, 서버로부터 JSON 응답을 받아 HTML 요소에 해당 데이터를 표시-->
      
    document.querySelectorAll('.keyword-button').forEach(button => {
            button.addEventListener('click', function() {
                var keyword = this.textContent;
                fetchConversation(keyword);
            });
        });

        function fetchConversation(keyword) {
            
            fetch("{% url 'history' %}", {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': '{{ csrf_token }}'
            },
            body: JSON.stringify({ keyword: keyword })
        })
        .then(response => response.json())
        .then(data => {
            var chatArea = document.getElementById('chat-area');
            chatArea.innerHTML = ''; 

            
            data.forEach(item => {
                var botMessage = document.createElement('div');
                botMessage.className = 'message bot-message';
                botMessage.innerHTML = `<div class="message-content">${item.chatting_output}</div>`;
                chatArea.appendChild(botMessage);
            });
        })
        .catch(error => {
            console.error('Error fetching conversation:', error);
        });
    }
    </script>
